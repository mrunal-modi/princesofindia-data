====== Load CSV

LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/mrunal-modi/princesofindia-data/main/_persons_location.csv' AS row
MERGE (p:Person {name: row.name, bio: row.bio}) // Assuming 'name' and 'bio' are columns in your CSV
MERGE (r:Region {name: row.region}) // Replace 'region' with the actual column name for regions
MERGE (l:Location {name: row.location}) // Replace 'location' with the actual column name for locations
MERGE (p)-[:LOCATED_IN]->(l)
MERGE (l)-[:PART_OF]->(r)

====== Queries

Find a Specific Person (Case-Insensitive):
MATCH (p:Person) 
WHERE p.name =~ '.*KUBER.*'
RETURN p


Find Persons in a Specific Location (Case-Insensitive):
MATCH (p:Person)-[:LOCATED_IN]->(l:Location)
WHERE l.name =~ '(?i)ahmedabad'
RETURN p.name


List All Persons Matching Partial Name (Case-Insensitive):
MATCH (p:Person)
WHERE p.name CONTAINS 'KUBER'
RETURN p.name, p.bio